use std::io::prelude::*;
use std::os::unix::net::UnixStream;

use extern_execve_poc::*;

fn main() -> Result<(), Box<dyn std::error::Error>> {
    let mut stream = UnixStream::connect("/run/user/1000/extern-execve-poc.sock")?;

    let msg_data = [0; MSG_DATA_MAX]; // not going into the details of msg_data yet
    let msg = Message {
        length: msg_data.len() as u32,
        mtype: MessageType::ExternExecve as u32,
        data: msg_data,
    };

    stream.write_all(msg.as_bytes())?;

    Ok(())
}
