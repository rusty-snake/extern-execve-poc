use std::io::prelude::*;
use std::os::unix::net::UnixStream;

use extern_execve_poc::*;

fn main() -> Result<(), Box<dyn std::error::Error>> {
    let mut stream = UnixStream::connect("/run/user/1000/extern-execve-poc.sock")?;

    let msg_data = *b"Hello World";
    let msg = Message::new(MessageType::ExternExecve, &msg_data);
    stream.write_all(msg.as_bytes())?;

    Ok(())
}
